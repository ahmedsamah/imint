colnames(all_ea) <- cnames_chart
labels <- c(rep("Total", nrow(total_ea) - 1),
rep("Middle", nrow(middle_ea) - 1),
rep("Bottom", nrow(bottom_ea) - 1),
rep("All series", nrow(all_ea) - 1))
series_ea <- rbind(total_ea[-1,],
middle_ea[-1,],
bottom_ea[-1,],
all_ea[-1,])
series_ea$Category <- labels
series_ea <- series_ea %>%
mutate(Weighting = case_when(
grepl("ols", Method) ~ "OLS",
grepl("wlss", Method) ~ "WLSs",
grepl("wlsv", Method) ~ "WLSv",
#   grepl("sam", Method) ~ "MinT(Sample)",
grepl("shrink", Method) ~ "MinT(Shrink)"
),
Immute = case_when(
grepl("I", Method) ~ "I",
grepl("iMinT", Method) ~ "I-MinT"
))
series_ea_long <- series_ea %>%
pivot_longer(cols = 2:6,
names_to = "Horizon",
values_to = "PC")
series_ea_long$Horizon <- factor(series_ea_long$Horizon,
levels = c("1", "4", "8", "12", "24"))
series_ea_long %>%
#  filter(Weighting == "WLSv") %>%
filter(Category != "Total") %>%
ggplot(aes(x = Horizon, y = PC, color = Weighting, group = interaction(Weighting, Immute), linetype = Immute)) +
geom_line(linewidth = 0.4) +
geom_point(aes(shape = Immute), size = 1) +  # Keep points for the immutability legend
scale_color_manual(values = c("OLS" = "blue", "WLSs" = "darkgreen", "WLSv" = "red",
#  "MinT(Sample)" = "violet",
"MinT(Shrink)" = "orange")) +
scale_linetype_manual(values = c("I" = "dashed", "I-MinT" = "solid")) +
labs(title = "Forecast Accuracies by Levels of the Structure (ETS+ARIMA) - Scenario 1",
x = "Forecast Horizon (Months)",
y = "% Deviation from Base Forecast MSE",
color = "W matrix",
shape = "Immutability",
linetype = "Immutability") +
geom_hline(yintercept = 0, color = "black", size = 0.2) +
theme_minimal() +
facet_wrap(~Category, scales = "free_y", ncol = 3) +
guides(
color = guide_legend(override.aes = list(shape = NA)),  # Remove dots from W matrix legend
# shape = guide_legend(override.aes = list(linetype = "blank"))  # Keep dots for Immutability legend
) +
theme(
plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size = 8),
axis.text = element_text(size = 6),
legend.title = element_text(size = 8, face = "bold"),
legend.text = element_text(size = 6),
strip.text = element_text(size = 6),
aspect.ratio = 1
)
series_long %>%
#  filter(Weighting == "WLSv") %>%
#  filter(Category != "Total") %>%
ggplot(aes(x = Horizon, y = PC, color = Weighting, group = interaction(Weighting, Immute), linetype = Immute)) +
geom_line(linewidth = 0.4) +
geom_point(aes(shape = Immute), size = 1) +  # Keep points for the immutability legend
scale_color_manual(values = c("OLS" = "blue", "WLSs" = "darkgreen", "WLSv" = "red", "MinT(Shrink)" = "orange")) +
scale_linetype_manual(values = c("I" = "dashed", "I-MinT" = "solid")) +
labs(title = "Forecast Accuracies by Reconciliation Method (ETS+ETS) - Scenario 1",
x = "Forecast Horizon (Months)",
y = "% Deviation from Base Forecast MSE",
color = "W matrix",
shape = "Immutability",
linetype = "Immutability") +
geom_hline(yintercept = 0, color = "black", size = 0.2) +
theme_minimal() +
facet_wrap(Category~Weighting, scales = "free_y", ncol = 4) +
guides(
color = guide_legend(override.aes = list(shape = NA)),  # Remove dots from W matrix legend
# shape = guide_legend(override.aes = list(linetype = "blank"))  # Keep dots for Immutability legend
) +
theme(
plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size = 8),
axis.text = element_text(size = 6),
legend.title = element_text(size = 8, face = "bold"),
legend.text = element_text(size = 6),
strip.text = element_text(size = 6),
aspect.ratio = 0.8
)
series_ea_long %>%
#  filter(Weighting == "WLSv") %>%
# filter(Category != "Total") %>%
ggplot(aes(x = Horizon, y = PC, color = Weighting, group = interaction(Weighting, Immute), linetype = Immute)) +
geom_line(linewidth = 0.4) +
geom_point(aes(shape = Immute), size = 1) +  # Keep points for the immutability legend
scale_color_manual(values = c("OLS" = "blue", "WLSs" = "darkgreen", "WLSv" = "red", "MinT(Shrink)" = "orange")) +
scale_linetype_manual(values = c("I" = "dashed", "I-MinT" = "solid")) +
labs(title = "Forecast Accuracies by Reconciliation Method (ETS+ARIMA) - Scenario 1",
x = "Forecast Horizon (Months)",
y = "% Deviation from Base Forecast MSE",
color = "W matrix",
shape = "Immutability",
linetype = "Immutability") +
geom_hline(yintercept = 0, color = "black", linewidth = 0.2) +
theme_minimal() +
facet_wrap(Category~Weighting, scales = "free_y", ncol = 4) +
guides(
color = guide_legend(override.aes = list(shape = NA)),  # Remove dots from W matrix legend
# shape = guide_legend(override.aes = list(linetype = "blank"))  # Keep dots for Immutability legend
) +
theme(
plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size = 8),
axis.text = element_text(size = 6),
legend.title = element_text(size = 8, face = "bold"),
legend.text = element_text(size = 6),
strip.text = element_text(size = 6),
aspect.ratio = 0.8
)
pc1_s2 <- read_csv("pc/pc1_s2.csv")
pc4_s2 <- read_csv("pc/pc4_s2.csv")
pc8_s2 <- read_csv("pc/pc8_s2.csv")
pc12_s2 <- read_csv("pc/pc12_s2.csv")
pc24_s2 <- read_csv("pc/pc24_s2.csv")
cnames <- c("Method", "h = 1", "4", "8", "12", "24")
cnames2 <- c("M", "h1", "h4", "h8", "h12", "h24")
total_s2 <- data.frame("method" = pc1_s2[,1],
"h = 1" = pc1_s2[,2],
"4" = pc4_s2[,2],
"8" = pc8_s2[,2],
"12" = pc12_s2[,2],
"24" = pc24_s2[,2]) %>%
mutate(across(where(is.numeric), ~ round(., 3)))
colnames(total_s2) <- cnames
middle_s2 <- data.frame("method" = pc1_s2[,1],
"h = 1" = pc1_s2[,3],
"4" = pc4_s2[,3],
"8" = pc8_s2[,3],
"12" = pc12_s2[,3],
"24" = pc24_s2[,3]) %>%
mutate(across(where(is.numeric), ~ round(., 3)))
colnames(middle_s2) <- cnames2
bottom_s2 <- data.frame("method" = pc1_s2[,1],
"h = 1" = pc1_s2[,4],
"4" = pc4_s2[,4],
"8" = pc8_s2[,4],
"12" = pc12_s2[,4],
"24" = pc24_s2[,4]) %>%
mutate(across(where(is.numeric), ~ round(., 3)))
colnames(bottom_s2) <- cnames
all_s2 <- data.frame("method" = pc1_s2[,1],
"h = 1" = pc1_s2[,5],
"4" = pc4_s2[,5],
"8" = pc8_s2[,5],
"12" = pc12_s2[,5],
"24" = pc24_s2[,5]) %>%
mutate(across(where(is.numeric), ~ round(., 3)))
colnames(all_s2) <- cnames2
all_total_s2 <- cbind(all_s2, total_s2[,-1]) %>%
slice(c(1, 2, 6, 3, 7, 4, 8, 5, 9)) %>%
mutate(W = c("Base", "OLS", "OLS", "WLSs", "WLSs", "WLSv", "WLSv",
#"MinT(Sample)", "MinT(Sample)",
"MinT(Shrink)", "MinT(Shrink)"),
ImmuteMethod = c(" ", "I", "I-MinT", "I", "I-MinT", "I", "I-MinT",
# "I", "I-MinT",
"I", "I-MinT")) %>%
select(c(12,13,2:11))
mid_bottom_s2 <- cbind(middle_s2, bottom_s2[,-1]) %>%
slice(c(1, 2, 6, 3, 7, 4, 8, 5, 9)) %>%
mutate(W = c("Base", "OLS", "OLS", "WLSs", "WLSs", "WLSv", "WLSv",
#  "MinT(Sample)", "MinT(Sample)",
"MinT(Shrink)", "MinT(Shrink)"),
ImmuteMethod = c(" ", "I", "I-MinT", "I", "I-MinT", "I", "I-MinT",
#    "I", "I-MinT",
"I", "I-MinT")) %>%
select(c(12,13,2:11))
at_table_s2 <- all_total_s2 %>%
kable(escape = FALSE,
caption="\\label{tab:tourismets}Out-of-sample forecast accuracy for ETS forecasts for all levels under Scenario 2.",
col.names = c(" ", " ", "h = 1", "4", "8", "12", "24", "h = 1", "4", "8", "12", "24")
) %>%
kable_styling(full_width = FALSE,
latex_options = c("hold_position"),
font_size = 7) %>%
add_header_above(c(" " =2, "All Series" = 5, "Total" = 5), bold = TRUE) %>%
add_header_above(c("ETS+ETS"=12), bold = TRUE) %>%
column_spec(c(1), width = "1.5cm") %>%
column_spec(c(2), width = "1cm") %>%
column_spec(3, bold = ifelse(all_total_s2$`h1`==min(all_total_s2$`h1`), T, F), width = "1cm") %>%
column_spec(4, bold = ifelse(all_total_s2$`h4`==min(all_total_s2$`h4`), T, F), width = "1cm") %>%
column_spec(5, bold = ifelse(all_total_s2$`h8`==min(all_total_s2$`h8`), T, F), width = "1cm") %>%
column_spec(6, bold = ifelse(all_total_s2$`h12`==min(all_total_s2$`h12`), T, F), width = "1cm") %>%
column_spec(7, bold = ifelse(all_total_s2$`h24`==min(all_total_s2$`h24`), T, F), width = "1cm") %>%
column_spec(8:12, width = "1cm") %>%
row_spec(1, bold = FALSE, italic = TRUE) %>%
collapse_rows(1, latex_hline ="major")
mb_table_s2 <- mid_bottom_s2 %>%
kable(escape = FALSE,
#  caption="\\label{tab:tourismets}Out-of-sample forecast accuracy for ETS forecasts for all levels under Scenario 1.",
col.names = c(" ", " ", "h = 1", "4", "8", "12", "24", "h = 1", "4", "8", "12", "24")
) %>%
kable_styling(full_width = FALSE,
latex_options = c("hold_position"),
font_size = 7) %>%
add_header_above(c(" " =2, "Middle" = 5, "Bottom" = 5), bold = TRUE) %>%
column_spec(c(1), width = "1.5cm") %>%
column_spec(c(2), width = "1cm") %>%
column_spec(3, bold = ifelse(mid_bottom_s2$`h1`==min(mid_bottom_s2$`h1`), T, F), width = "1cm") %>%
column_spec(4, bold = ifelse(mid_bottom_s2$`h4`==min(mid_bottom_s2$`h4`), T, F), width = "1cm") %>%
column_spec(5, bold = ifelse(mid_bottom_s2$`h8`==min(mid_bottom_s2$`h8`), T, F), width = "1cm") %>%
column_spec(6, bold = ifelse(mid_bottom_s2$`h12`==min(mid_bottom_s2$`h12`), T, F), width = "1cm") %>%
column_spec(7, bold = ifelse(mid_bottom_s2$`h24`==min(mid_bottom_s2$`h24`), T, F), width = "1cm") %>%
column_spec(8, bold = ifelse(mid_bottom_s2$`h = 1`==min(mid_bottom_s2$`h = 1`), T, F), width = "1cm") %>%
column_spec(9, bold = ifelse(mid_bottom_s2$`4`==min(mid_bottom_s2$`4`), T, F), width = "1cm") %>%
column_spec(10, bold = ifelse(mid_bottom_s2$`8`==min(mid_bottom_s2$`8`), T, F), width = "1cm") %>%
column_spec(11, bold = ifelse(mid_bottom_s2$`12`==min(mid_bottom_s2$`12`), T, F), width = "1cm") %>%
column_spec(12, bold = ifelse(mid_bottom_s2$`24`==min(mid_bottom_s2$`24`), T, F), width = "1cm") %>%
row_spec(1, bold = FALSE, italic = TRUE) %>%
collapse_rows(1, latex_hline ="major")
cat(paste0(at_table_s2, "\\vspace{-2.5em}", mb_table_s2), sep = "")
pc1_ea_s2 <- read_csv("pc/pc1_ea_s2.csv")
pc4_ea_s2 <- read_csv("pc/pc4_ea_s2.csv")
pc8_ea_s2 <- read_csv("pc/pc8_ea_s2.csv")
pc12_ea_s2 <- read_csv("pc/pc12_ea_s2.csv")
pc24_ea_s2 <- read_csv("pc/pc24_ea_s2.csv")
cnames <- c("Method", "h = 1", "4", "8", "12", "24")
cnames2 <- c("M", "h1", "h4", "h8", "h12", "h24")
total_ea_s2 <- data.frame("method" = pc1_ea_s2[,1],
"h = 1" = pc1_ea_s2[,2],
"4" = pc4_ea_s2[,2],
"8" = pc8_ea_s2[,2],
"12" = pc12_ea_s2[,2],
"24" = pc24_ea_s2[,2]) %>%
mutate(across(where(is.numeric), ~ round(., 3)))
colnames(total_ea_s2) <- cnames
middle_ea_s2 <- data.frame("method" = pc1_ea_s2[,1],
"h = 1" = pc1_ea_s2[,3],
"4" = pc4_ea_s2[,3],
"8" = pc8_ea_s2[,3],
"12" = pc12_ea_s2[,3],
"24" = pc24_ea_s2[,3]) %>%
mutate(across(where(is.numeric), ~ round(., 3)))
colnames(middle_ea_s2) <- cnames2
bottom_ea_s2 <- data.frame("method" = pc1_ea_s2[,1],
"h = 1" = pc1_ea_s2[,4],
"4" = pc4_ea_s2[,4],
"8" = pc8_ea_s2[,4],
"12" = pc12_ea_s2[,4],
"24" = pc24_ea_s2[,4]) %>%
mutate(across(where(is.numeric), ~ round(., 3)))
colnames(bottom_ea_s2) <- cnames
all_ea_s2 <- data.frame("method" = pc1_ea_s2[,1],
"h = 1" = pc1_ea_s2[,5],
"4" = pc4_ea_s2[,5],
"8" = pc8_ea_s2[,5],
"12" = pc12_ea_s2[,5],
"24" = pc24_ea_s2[,5]) %>%
mutate(across(where(is.numeric), ~ round(., 3)))
colnames(all_ea_s2) <- cnames2
all_total_ea_s2 <- cbind(all_ea_s2, total_ea_s2[,-1]) %>%
slice(c(1, 2, 6, 3, 7, 4, 8, 5, 9)) %>%
mutate(W = c("Base", "OLS", "OLS", "WLSs", "WLSs", "WLSv", "WLSv",
#  "MinT(Sample)", "MinT(Sample)",
"MinT(Shrink)", "MinT(Shrink)"),
ImmuteMethod = c(" ", "I", "I-MinT", "I", "I-MinT", "I", "I-MinT",
#    "I", "I-MinT",
"I", "I-MinT")) %>%
select(c(12,13,2:11))
mid_bottom_ea_s2 <- cbind(middle_ea_s2, bottom_ea_s2[,-1]) %>%
slice(c(1, 2, 6, 3, 7, 4, 8, 5, 9)) %>%
mutate(W = c("Base", "OLS", "OLS", "WLSs", "WLSs", "WLSv", "WLSv",
#  "MinT(Sample)", "MinT(Sample)",
"MinT(Shrink)", "MinT(Shrink)"),
ImmuteMethod = c(" ", "I", "I-MinT", "I", "I-MinT", "I", "I-MinT",
#  "I", "I-MinT",
"I", "I-MinT")) %>%
select(c(12,13,2:11))
at_table_ea_s2 <- all_total_ea_s2 %>%
kable(escape = FALSE,
caption="\\label{tab:tourismets}Out-of-sample forecast accuracy when ETS forecasts at top-level and ARIMA forecasts for other levels - under Scenario 2.",
col.names = c(" ", " ", "h = 1", "4", "8", "12", "24", "h = 1", "4", "8", "12", "24")
) %>%
kable_styling(full_width = FALSE,
latex_options = c("hold_position"),
font_size = 7) %>%
add_header_above(c(" " =2, "All Series" = 5, "Total" = 5), bold = TRUE) %>%
add_header_above(c("ETS+ARIMA"=12), bold = TRUE) %>%
column_spec(c(1), width = "1.5cm") %>%
column_spec(c(2), width = "1cm") %>%
column_spec(3, bold = ifelse(all_total_ea_s2$`h1`==min(all_total_ea_s2$`h1`), T, F), width = "1cm") %>%
column_spec(4, bold = ifelse(all_total_ea_s2$`h4`==min(all_total_ea_s2$`h4`), T, F), width = "1cm") %>%
column_spec(5, bold = ifelse(all_total_ea_s2$`h8`==min(all_total_ea_s2$`h8`), T, F), width = "1cm") %>%
column_spec(6, bold = ifelse(all_total_ea_s2$`h12`==min(all_total_ea_s2$`h12`), T, F), width = "1cm") %>%
column_spec(7, bold = ifelse(all_total_ea_s2$`h24`==min(all_total_ea_s2$`h24`), T, F), width = "1cm") %>%
column_spec(8:12, width = "1cm") %>%
row_spec(1, bold = FALSE, italic = TRUE) %>%
collapse_rows(1, latex_hline ="major")
mb_table_ea_s2 <- mid_bottom_ea_s2 %>%
kable(escape = FALSE,
#  caption="\\label{tab:tourismets}Out-of-sample forecast accuracy for ETS forecasts for all levels under Scenario 1.",
col.names = c(" ", " ", "h = 1", "4", "8", "12", "24", "h = 1", "4", "8", "12", "24")
) %>%
kable_styling(full_width = FALSE,
latex_options = c("hold_position"),
font_size = 7) %>%
add_header_above(c(" " =2, "Middle" = 5, "Bottom" = 5), bold = TRUE) %>%
column_spec(c(1), width = "1.5cm") %>%
column_spec(c(2), width = "1cm") %>%
column_spec(3, bold = ifelse(mid_bottom_ea_s2$`h1`==min(mid_bottom_ea_s2$`h1`), T, F), width = "1cm") %>%
column_spec(4, bold = ifelse(mid_bottom_ea_s2$`h4`==min(mid_bottom_ea_s2$`h4`), T, F), width = "1cm") %>%
column_spec(5, bold = ifelse(mid_bottom_ea_s2$`h8`==min(mid_bottom_ea_s2$`h8`), T, F), width = "1cm") %>%
column_spec(6, bold = ifelse(mid_bottom_ea_s2$`h12`==min(mid_bottom_ea_s2$`h12`), T, F), width = "1cm") %>%
column_spec(7, bold = ifelse(mid_bottom_ea_s2$`h24`==min(mid_bottom_ea_s2$`h24`), T, F), width = "1cm") %>%
column_spec(8, bold = ifelse(mid_bottom_ea_s2$`h = 1`==min(mid_bottom_ea_s2$`h = 1`), T, F), width = "1cm") %>%
column_spec(9, bold = ifelse(mid_bottom_ea_s2$`4`==min(mid_bottom_ea_s2$`4`), T, F), width = "1cm") %>%
column_spec(10, bold = ifelse(mid_bottom_ea_s2$`8`==min(mid_bottom_ea_s2$`8`), T, F), width = "1cm") %>%
column_spec(11, bold = ifelse(mid_bottom_ea_s2$`12`==min(mid_bottom_ea_s2$`12`), T, F), width = "1cm") %>%
column_spec(12, bold = ifelse(mid_bottom_ea_s2$`24`==min(mid_bottom_ea_s2$`24`), T, F), width = "1cm") %>%
row_spec(1, bold = FALSE, italic = TRUE) %>%
collapse_rows(1, latex_hline ="major")
cat(paste0(at_table_ea_s2, "\\vspace{-2.5em}", mb_table_ea_s2), sep = "")
cnames_chart <- c("Method", "1", "4", "8", "12", "24")
colnames(total_s2) <- cnames_chart
colnames(middle_s2) <- cnames_chart
colnames(bottom_s2) <- cnames_chart
colnames(all_s2) <- cnames_chart
labels <- c(rep("Total", nrow(total_s2) - 1),
rep("Middle", nrow(middle_s2) - 1),
rep("Bottom", nrow(bottom_s2) - 1),
rep("All series", nrow(all_s2) - 1))
series_s2 <- rbind(total_s2[-1,],
middle_s2[-1,],
bottom_s2[-1,],
all_s2[-1,])
series_s2$Category <- labels
series_s2 <- series_s2 %>%
mutate(Weighting = case_when(
grepl("ols", Method) ~ "OLS",
grepl("wlss", Method) ~ "WLSs",
grepl("wlsv", Method) ~ "WLSv",
#  grepl("sam", Method) ~ "MinT(Sample)",
grepl("shrink", Method) ~ "MinT(Shrink)"
),
Immute = case_when(
grepl("I", Method) ~ "I",
grepl("iMinT", Method) ~ "I-MinT"
))
series_s2_long <- series_s2 %>%
pivot_longer(cols = 2:6,
names_to = "Horizon",
values_to = "PC")
series_s2_long$Horizon <- factor(series_s2_long$Horizon,
levels = c("1", "4", "8", "12", "24"))
series_s2_long %>%
#  filter(Weighting == "WLSv") %>%
filter(Category != "Total") %>%
ggplot(aes(x = Horizon, y = PC, color = Weighting, group = interaction(Weighting, Immute), linetype = Immute)) +
geom_line(linewidth = 0.4) +
geom_point(aes(shape = Immute), size = 1) +  # Keep points for the immutability legend
scale_color_manual(values = c("OLS" = "blue", "WLSs" = "darkgreen", "WLSv" = "red",
# "MinT(Sample)" = "violet",
"MinT(Shrink)" = "orange")) +
scale_linetype_manual(values = c("I" = "dashed", "I-MinT" = "solid")) +
labs(title = "Forecast Accuracies by Levels of the Structure (ETS+ETS) - Scenario 2",
x = "Forecast Horizon (Months)",
y = "% Deviation from Base Forecast MSE",
color = "W matrix",
shape = "Immutability",
linetype = "Immutability") +
geom_hline(yintercept = 0, color = "black", size = 0.2) +
theme_minimal() +
facet_wrap(~Category, scales = "free_y", ncol = 3) +
guides(
color = guide_legend(override.aes = list(shape = NA)),  # Remove dots from W matrix legend
# shape = guide_legend(override.aes = list(linetype = "blank"))  # Keep dots for Immutability legend
) +
theme(
plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size = 8),
axis.text = element_text(size = 6),
legend.title = element_text(size = 8, face = "bold"),
legend.text = element_text(size = 6),
strip.text = element_text(size = 6),
aspect.ratio = 1
)
cnames_chart <- c("Method", "1", "4", "8", "12", "24")
colnames(total_ea_s2) <- cnames_chart
colnames(middle_ea_s2) <- cnames_chart
colnames(bottom_ea_s2) <- cnames_chart
colnames(all_ea_s2) <- cnames_chart
labels <- c(rep("Total", nrow(total_ea_s2) - 1),
rep("Middle", nrow(middle_ea_s2) - 1),
rep("Bottom", nrow(bottom_ea_s2) - 1),
rep("All series", nrow(all_ea_s2) - 1))
series_ea_s2 <- rbind(total_ea_s2[-1,],
middle_ea_s2[-1,],
bottom_ea_s2[-1,],
all_ea_s2[-1,])
series_ea_s2$Category <- labels
series_ea_s2 <- series_ea_s2 %>%
mutate(Weighting = case_when(
grepl("ols", Method) ~ "OLS",
grepl("wlss", Method) ~ "WLSs",
grepl("wlsv", Method) ~ "WLSv",
#   grepl("sam", Method) ~ "MinT(Sample)",
grepl("shrink", Method) ~ "MinT(Shrink)"
),
Immute = case_when(
grepl("I", Method) ~ "I",
grepl("iMinT", Method) ~ "I-MinT"
))
series_ea_s2_long <- series_ea_s2 %>%
pivot_longer(cols = 2:6,
names_to = "Horizon",
values_to = "PC")
series_ea_s2_long$Horizon <- factor(series_ea_s2_long$Horizon,
levels = c("1", "4", "8", "12", "24"))
series_ea_s2_long %>%
#  filter(Weighting == "WLSv") %>%
filter(Category != "Total") %>%
ggplot(aes(x = Horizon, y = PC, color = Weighting, group = interaction(Weighting, Immute), linetype = Immute)) +
geom_line(linewidth = 0.4) +
geom_point(aes(shape = Immute), size = 1) +  # Keep points for the immutability legend
scale_color_manual(values = c("OLS" = "blue", "WLSs" = "darkgreen", "WLSv" = "red",
# "MinT(Sample)" = "violet",
"MinT(Shrink)" = "orange")) +
scale_linetype_manual(values = c("I" = "dashed", "I-MinT" = "solid")) +
labs(title = "Forecast Accuracies by Levels of the Structure (ETS+ARIMA) - Scenario 2",
x = "Forecast Horizon (Months)",
y = "% Deviation from Base Forecast MSE",
color = "W matrix",
shape = "Immutability",
linetype = "Immutability") +
geom_hline(yintercept = 0, color = "black", size = 0.2) +
theme_minimal() +
facet_wrap(~Category, scales = "free_y", ncol = 3) +
guides(
color = guide_legend(override.aes = list(shape = NA)),  # Remove dots from W matrix legend
# shape = guide_legend(override.aes = list(linetype = "blank"))  # Keep dots for Immutability legend
) +
theme(
plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size = 8),
axis.text = element_text(size = 6),
legend.title = element_text(size = 8, face = "bold"),
legend.text = element_text(size = 6),
strip.text = element_text(size = 6),
aspect.ratio = 1
)
series_s2_long %>%
#  filter(Weighting == "WLSv") %>%
#  filter(Category != "Total") %>%
ggplot(aes(x = Horizon, y = PC, color = Weighting, group = interaction(Weighting, Immute), linetype = Immute)) +
geom_line(linewidth = 0.4) +
geom_point(aes(shape = Immute), size = 1) +  # Keep points for the immutability legend
scale_color_manual(values = c("OLS" = "blue", "WLSs" = "darkgreen", "WLSv" = "red", "MinT(Shrink)" = "orange")) +
scale_linetype_manual(values = c("I" = "dashed", "I-MinT" = "solid")) +
labs(title = "Forecast Accuracies by Reconciliation Method (ETS+ETS) - Scenario 2",
x = "Forecast Horizon (Months)",
y = "% Deviation from Base Forecast MSE",
color = "W matrix",
shape = "Immutability",
linetype = "Immutability") +
geom_hline(yintercept = 0, color = "black", size = 0.2) +
theme_minimal() +
facet_wrap(Category~Weighting, scales = "free_y", ncol = 4) +
guides(
color = guide_legend(override.aes = list(shape = NA)),  # Remove dots from W matrix legend
# shape = guide_legend(override.aes = list(linetype = "blank"))  # Keep dots for Immutability legend
) +
theme(
plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size = 8),
axis.text = element_text(size = 6),
legend.title = element_text(size = 8, face = "bold"),
legend.text = element_text(size = 6),
strip.text = element_text(size = 6),
aspect.ratio = 0.8
)
series_ea_s2_long %>%
#  filter(Weighting == "WLSv") %>%
# filter(Category != "Total") %>%
ggplot(aes(x = Horizon, y = PC, color = Weighting, group = interaction(Weighting, Immute), linetype = Immute)) +
geom_line(linewidth = 0.4) +
geom_point(aes(shape = Immute), size = 1) +  # Keep points for the immutability legend
scale_color_manual(values = c("OLS" = "blue", "WLSs" = "darkgreen", "WLSv" = "red", "MinT(Shrink)" = "orange")) +
scale_linetype_manual(values = c("I" = "dashed", "I-MinT" = "solid")) +
labs(title = "Forecast Accuracies by Reconciliation Method (ETS+ARIMA) - Scenario 2",
x = "Forecast Horizon (Months)",
y = "% Deviation from Base Forecast MSE",
color = "W matrix",
shape = "Immutability",
linetype = "Immutability") +
geom_hline(yintercept = 0, color = "black", linewidth = 0.2) +
theme_minimal() +
facet_wrap(Category~Weighting, scales = "free_y", ncol = 4) +
guides(
color = guide_legend(override.aes = list(shape = NA)),  # Remove dots from W matrix legend
# shape = guide_legend(override.aes = list(linetype = "blank"))  # Keep dots for Immutability legend
) +
theme(
plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size = 8),
axis.text = element_text(size = 6),
legend.title = element_text(size = 8, face = "bold"),
legend.text = element_text(size = 6),
strip.text = element_text(size = 6),
aspect.ratio = 0.8
)
setwd("~/Library/CloudStorage/GoogleDrive-asam23@student.monash.edu/My Drive/Files/Monash/Master_of_Applied_Econometrics/2024S1/ETC5860_HonoursResearchProject/ResearchProject/simulations/simulation_q")
setwd("~/Library/CloudStorage/GoogleDrive-asam23@student.monash.edu/My Drive/Files/Monash/Master_of_Applied_Econometrics/2024S1/ETC5860_HonoursResearchProject/ResearchProject/simulations/simulation")
